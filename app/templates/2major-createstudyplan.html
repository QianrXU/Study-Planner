{% extends "base.html" %}
{% block content %}

<div class="vertical">
  <div class="progress"><div class="progress-bar" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div></div>
    <div class="step1content container">
      <p class="gainanexperiencerich" style="text-transform: uppercase;">Gain an experience rich education</p>
      <h1 class="divheading">Create Study Plan</h1>
      <p>Select the major or specialisation you wish to pursue within your course.</p>

        <div class="selectcourse dropdown">
          <button class="btn btn-secondary dropdown-toggle" id="selectmajor1" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Select your major or specialisation
          </button>
          <!-- Pulls data from the ListMajors column -->
          <ul class="dropdown-menu" id="selectedmajor1" aria-labelledby="selectmajor1">
            <!-- <li><a class="dropdown-item" href="#">Not applicable</a></li>
            <div class="dropdown-divider"></div> -->
            {% for value in majors %}
            <li><a class="dropdown-item" href="#">{{value}}</a></li>
            {% endfor %}
          </ul>
        </div>
        <div class="selectcourse dropdown">
          <button class="btn btn-secondary dropdown-toggle" id="selectmajor2" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Select your major or specialisation
          </button>
          <!-- Pulls data from the ListMajors column -->
          <ul class="dropdown-menu" id="selectedmajor2" aria-labelledby="selectmajor2">
            <!-- <li><a class="dropdown-item" href="#">Not applicable</a></li>
            <div class="dropdown-divider"></div> -->
            {% for value in majors %}
            <li><a class="dropdown-item" href="#">{{value}}</a></li>
            {% endfor %}
          </ul>
        </div>

        <a href="{{ url_for('createstudyplanSelectUnits') }}" class ="button_general" id="selectcoursebutton">Continue<span class="arrow"><i class="fa-sharp fa-solid fa-angles-right" id="buttonarrow"></i></span></a>
        
  </div>
</div>


<script>

// MAJOR1 DROPDOWN
$("#selectedmajor1 a").click(function(){
  event.preventDefault(); // prevents page scroll when button clicked
  selected_major = $(this).text();
  document.getElementById("selectmajor1").innerHTML = selected_major;
})

/* Event listener - listens for changes to major1 dropdown (detects whenever a user changes a major) */
changed_selected_major = document.getElementById("selectmajor1");
observer = new MutationObserver(function(mutationsList, observer) {detectedChange();});
observer.observe(changed_selected_major, {characterData: false, childList: true, attributes: false});

// MAJOR2 DROPDOWN
$("#selectedmajor2 a").click(function(){
  event.preventDefault(); // prevents page scroll when button clicked
  selected_major = $(this).text();
  document.getElementById("selectmajor2").innerHTML = selected_major;
})

/* Event listener - listens for changes to major2 dropdown (detects whenever a user changes a major) */
changed_selected_major = document.getElementById("selectmajor2");
observer = new MutationObserver(function(mutationsList, observer) {detectedChange();});
observer.observe(changed_selected_major, {characterData: false, childList: true, attributes: false});

/* Function when major is changed */
function detectedChange(){
  // posts new major selection to console log
  detected_major1 = document.getElementById("selectmajor1").innerHTML;
  console.log(detected_major1);
  detected_major2 = document.getElementById("selectmajor2").innerHTML;
  console.log(detected_major2);

  // if the major selection is changed, it sends the change to the backend
  $.ajax({
    type: "POST",
    url: "{{ url_for('createstudyplanSelectMajor') }}",
    data: {"name": detected_major1}
  })
}

</script>

{% endblock %}